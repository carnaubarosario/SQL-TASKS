
CREATE DATABASE TRAGER;

USE TRAGER;

CREATE TABLE USUARIO(
	IDUSUARIO INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR (30) NOT NULL,
	LOGIN VARCHAR (30) NOT NULL,
	SENHA VARCHAR (100) NOT NULL
);

CREATE TABLE BKP_USUARIO(
	IDBACKUP INT PRIMARY KEY AUTO_INCREMENT,
	IDUSUARIO INT,
	NOME VARCHAR (30) NOT NULL,
	LOGIN VARCHAR (30) NOT NULL 
);

-- CRIANDO A TRIGGER 

DELIMITER #
CREATE TRIGGER BACKUP_USER
	BEFORE DELETE ON USUARIO 
	FOR EACH ROW
	BEGIN

		INSERT INTO BKP_USUARIO VALUES 
		(NULL, OLD.IDUSUARIO, OLD.NOME, OLD.LOGIN);



	END 
	#

DELIMITER ;

INSERT INTO USUARIO VALUES (NULL, 'MURICY RAMALHO', 'MRAMALHO2008', 'HEXACAMPEAO');

DELETE FROM USUARIO WHERE IDUSUARIO = 1;